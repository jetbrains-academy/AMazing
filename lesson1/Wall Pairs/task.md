A wall separates a pair of cells in the N-S or W-E directions.

Если у ячейки есть стена W, значит у соседней с ней ячейки должна быть стена E.

Сделайте dict, для того, чтобы легко определять парную стену для текущей.